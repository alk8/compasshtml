<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö–æ–º–ø–∞—Å</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      background: #111;
      color: #fff;
      font-family: sans-serif;
    }
    #compass {
      width: 200px;
      height: 200px;
      background: url('compass.png') no-repeat center/contain;
      transform: rotate(0deg);
      transition: transform 0.3s linear;
    }
    .controls {
      margin-top: 20px;
      display: flex;
      gap: 10px;
    }
    button {
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      background: #333;
      color: #fff;
    }
    button:hover {
      background: #444;
    }
  </style>
</head>
<body>
  <div id="compass"></div>

  <div class="controls">
    <button id="sound-button">üîà –í–∫–ª. –∑–≤—É–∫</button>
    <button id="pelengator-button">üì° –ü–µ–ª–µ–Ω–≥–∞—Ç–æ—Ä</button>
  </div>

  <script>
    // === –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∑–≤—É–∫–∞ ===
    let audioCtx = null;
    let oscillator = null;
    let isSoundOn = false;
    let isPelengatorOn = false;

    const compass = document.getElementById("compass");
    const soundBtn = document.getElementById("sound-button");
    const pelengatorBtn = document.getElementById("pelengator-button");

    // === –ö–ù–û–ü–ö–ê –ó–í–£–ö–ê ===
    soundBtn.addEventListener("click", async () => {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }

      if (audioCtx.state === "suspended") {
        await audioCtx.resume();
      }

      if (!isSoundOn) {
        oscillator = audioCtx.createOscillator();
        oscillator.type = "sine";
        oscillator.frequency.value = 440; // –±–∞–∑–æ–≤—ã–π —Ç–æ–Ω
        oscillator.connect(audioCtx.destination);
        oscillator.start();

        isSoundOn = true;
        soundBtn.textContent = "üîä –í—ã–∫–ª. –∑–≤—É–∫";
        console.log("–ó–≤—É–∫ –≤–∫–ª—é—á–µ–Ω");
      } else {
        if (oscillator) {
          oscillator.stop();
          oscillator.disconnect();
          oscillator = null;
        }
        isSoundOn = false;
        soundBtn.textContent = "üîà –í–∫–ª. –∑–≤—É–∫";
        console.log("–ó–≤—É–∫ –≤—ã–∫–ª—é—á–µ–Ω");
      }
    });

    // === –ö–ù–û–ü–ö–ê –ü–ï–õ–ï–ù–ì–ê–¢–û–†–ê ===
    pelengatorBtn.addEventListener("click", async () => {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
      if (audioCtx.state === "suspended") {
        await audioCtx.resume();
      }

      isPelengatorOn = !isPelengatorOn;
      pelengatorBtn.textContent = isPelengatorOn ? "‚ùå –°—Ç–æ–ø –ø–µ–ª–µ–Ω–≥–∞—Ç–æ—Ä" : "üì° –ü–µ–ª–µ–Ω–≥–∞—Ç–æ—Ä";
      console.log("–ü–µ–ª–µ–Ω–≥–∞—Ç–æ—Ä:", isPelengatorOn);
    });

    // === –û–ë–ù–û–í–õ–ï–ù–ò–ï –ö–û–ú–ü–ê–°–ê ===
    function updateCompass(angle) {
      compass.style.transform = `rotate(${angle}deg)`;

      if (isSoundOn && oscillator) {
        // –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –≥—É–ª –º–µ–Ω—è–µ—Ç—Å—è –ø–æ —É–≥–ª—É
        const freq = 200 + (angle % 180) * 5;
        oscillator.frequency.value = freq;
      }

      if (isPelengatorOn && oscillator) {
        // –ø–µ–ª–µ–Ω–≥–∞—Ç–æ—Ä: —á–µ–º –±–ª–∏–∂–µ –∫ —Å–µ–≤–µ—Ä—É, —Ç–µ–º –≤—ã—à–µ —Ç–æ–Ω
        const diff = Math.abs((angle % 360) - 0);
        oscillator.frequency.value = 800 - diff * 2;
      }
    }

    // === –ò–ú–ò–¢–ê–¶–ò–Ø –ö–û–ú–ü–ê–°–ê (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∞) ===
    let testAngle = 0;
    setInterval(() => {
      testAngle = (testAngle + 10) % 360;
      updateCompass(testAngle);
    }, 1000);

    // üß≠ –¢—É—Ç –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–≤–æ—è –ª–æ–≥–∏–∫–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –∏ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –∫–æ–º–ø–∞—Å–∞
    // navigator.geolocation.watchPosition(...) –∏ event.orientation(...)
    // –í updateCompass(angle) –∑–≤—É–∫ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
  </script>
</body>
</html>
